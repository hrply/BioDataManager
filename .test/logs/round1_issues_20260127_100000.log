# 第1轮测试 - 发现问题清单

## 发现时间
2026-01-27 10:00:00

## 已知问题（必须测试）

| 序号 | 问题 | 验证标准 |
|-----|------|---------|
| 1 | 文件下载功能 | 单文件/多文件下载成功 |
| 2 | 文件删除功能 | 软删除到回收站、记录更新 |
| 3 | 导入已有项目 | metadata_override 合并正确 |
| 4 | 逗号分隔处理 | 中文逗号→英文逗号 |
| 5 | 关联项目字段 | results_raw 存储、排序、去重 |

## 主动发现问题

### 问题6：multi_select 字段不一致
- **来源**：代码搜索
- **问题**：`database_mysql.py` 中有 `multi_select` 类型，但设计文档未提及
- **验证方法**：检查 `field_config` 表中 `field_type` 是否有 `multi_select`

### 问题7：API 响应字段名不一致
- **来源**：代码对比
- **问题**：`api_get_imported_projects` 返回 `project_id`，前端模板混用 `raw_id`/`results_id`
- **验证方法**：检查 API 响应字段名与前端模板变量名是否一致

### 问题8：引文解析功能
- **来源**：代码阅读
- **问题**：`citation_parser.py` 支持 .bib/.ris/.enw 格式，但未充分测试
- **验证方法**：测试不同格式的引文解析是否正确

### 问题9：路径生成边界条件
- **来源**：代码阅读 (`backend.py` `_build_raw_project_path`)
- **问题**：当 `tissue` 为空时，路径为二级结构，需要验证
- **验证方法**：测试 tissue 为空时的路径格式

### 问题10：缩写映射缺失处理
- **来源**：代码阅读 (`backend.py` `get_abbr`)
- **问题**：无 `abbr_mapping` 时取前3字符，需要验证
- **验证方法**：测试无缩写映射时的行为

### 问题11：get_all_processed_data 方法缺失
- **来源**：代码阅读 (`server.py`)
- **问题**：`api_get_processed_data` 调用 `get_manager().get_all_processed_data()`，但 backend.py 中可能不存在
- **验证方法**：检查方法是否实现

### 问题12：import_processed_file 方法缺失
- **来源**：代码阅读 (`server.py`)
- **问题**：`api_import_processed_file` 调用 `get_manager().import_processed_file()`
- **验证方法**：检查方法是否实现

### 问题13：并发处理 - 任务ID生成
- **来源**：代码阅读 (`server.py` `scan_tasks`)
- **问题**：任务使用字典存储，可能存在并发问题
- **验证方法**：测试快速连续请求任务创建

### 问题14：连接池初始化失败处理
- **来源**：代码阅读 (`database_mysql.py`)
- **问题**：`connect()` 方法有回退逻辑，但 `_init_pool` 失败后不重试
- **验证方法**：模拟连接池初始化失败场景

## 待测试用例清单

| TC-ID | 测试内容 | 问题编号 | 类型 |
|-------|---------|---------|-----|
| TC-DL-001 | 单文件下载 | 1 | 基础功能 |
| TC-DL-002 | 多文件下载 | 1 | 基础功能 |
| TC-DEL-001 | 删除到回收站 | 2 | 基础功能 |
| TC-DEL-002 | 记录同步更新 | 2 | 基础功能 |
| TC-IMP-001 | 导入到已有项目 | 3 | 基础功能 |
| TC-COMMA-001 | 中文逗号转换 | 4 | 基础功能 |
| TC-REF-001 | results_raw存储 | 5 | 基础功能 |
| TC-REF-002 | results_raw排序 | 5 | 边界条件 |
| TC-REF-003 | results_raw去重 | 5 | 边界条件 |
| TC-MS-001 | multi_select字段 | 6 | 代码验证 |
| TC-API-001 | API字段名一致性 | 7 | 代码验证 |
| TC-CIT-001 | 引文解析.BIB | 8 | 基础功能 |
| TC-CIT-002 | 引文解析.RIS | 8 | 基础功能 |
| TC-PATH-001 | 空tissue路径 | 9 | 边界条件 |
| TC-ABBR-001 | 无缩写映射 | 10 | 边界条件 |
| TC-METH-001 | get_all_processed_data | 11 | 方法验证 |
| TC-METH-002 | import_processed_file | 12 | 方法验证 |
| TC-CONC-001 | 并发任务创建 | 13 | 边界条件 |
| TC-POOL-001 | 连接池失败处理 | 14 | 边界条件 |

## 总结
- 已知问题：5个
- 主动发现问题：9个
- 总测试用例：18个
